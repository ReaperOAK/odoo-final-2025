import{r as i,j as e,l as u,L as g,b as f,c as N}from"./index-76169fad.js";import{r as h}from"./rentals-588bb37c.js";import{S as v}from"./StatusChip-0f94ae11.js";import{P as p}from"./PhotoIcon-c505ca73.js";import{f as m}from"./index-11ece73b.js";import"./index-e31d7439.js";function _(){const[t,d]=i.useState([]),[a,c]=i.useState(!0),[l,y]=i.useState("all");i.useEffect(()=>{o()},[]);const o=async()=>{var s;try{c(!0);const r=await h.getMyRentals();d(((s=r.data)==null?void 0:s.rentals)||[])}catch(r){console.error("Failed to fetch bookings:",r)}finally{c(!1)}},j=async s=>{if(confirm("Are you sure you want to cancel this booking?"))try{await h.cancelRental(s),await o()}catch(r){console.error("Failed to cancel booking:",r),alert("Failed to cancel booking. Please try again.")}},x=t.filter(s=>l==="all"?!0:s.status===l),n=(()=>({all:t.length,confirmed:t.filter(s=>s.status==="confirmed").length,picked_up:t.filter(s=>s.status==="picked_up").length,returned:t.filter(s=>s.status==="returned").length,cancelled:t.filter(s=>s.status==="cancelled").length}))();return a?e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-48 mb-8"}),e.jsx("div",{className:"grid gap-6",children:[...Array(3)].map((s,r)=>e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-200 rounded-lg"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/4"})]})]})},r))})]})})}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"My Bookings"}),e.jsx("p",{className:"text-gray-600",children:"Manage your equipment rentals"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:[{key:"all",label:"All Bookings",count:n.all},{key:"confirmed",label:"Confirmed",count:n.confirmed},{key:"picked_up",label:"Active",count:n.picked_up},{key:"returned",label:"Completed",count:n.returned},{key:"cancelled",label:"Cancelled",count:n.cancelled}].map(s=>e.jsxs("button",{onClick:()=>y(s.key),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${l===s.key?"bg-brand text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[s.label," (",s.count,")"]},s.key))})}),x.length>0?e.jsx("div",{className:"space-y-6",children:x.map(s=>e.jsx(w,{booking:s,onCancel:j},s._id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-24 h-24 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(u,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:l==="all"?"No bookings yet":`No ${l} bookings`}),e.jsx("p",{className:"text-gray-600 mb-4",children:l==="all"?"You haven't made any equipment rentals yet.":`You don't have any ${l} bookings at the moment.`}),l==="all"&&e.jsx(g,{to:"/products",className:"inline-flex items-center bg-brand text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Browse Equipment"})]})]})})}function w({booking:t,onCancel:d}){var l;const a=t.product,c=t.status==="confirmed"&&new Date(t.startDate)>new Date;return e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-lg overflow-hidden",children:(l=a==null?void 0:a.images)!=null&&l[0]?e.jsx("img",{src:a.images[0],alt:a.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(p,{className:"w-8 h-8 text-gray-400"})})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:(a==null?void 0:a.name)||"Product not found"}),e.jsx(v,{status:t.status})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-brand",children:["â‚¹",t.totalPrice]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Cost"})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(u,{className:"w-4 h-4 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Start Date"}),e.jsx("div",{children:m(new Date(t.startDate),"MMM dd, yyyy HH:mm")})]})]}),e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"End Date"}),e.jsx("div",{children:m(new Date(t.endDate),"MMM dd, yyyy HH:mm")})]})]}),e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Duration"}),e.jsxs("div",{children:[Math.ceil((new Date(t.endDate)-new Date(t.startDate))/(1e3*60*60*24))," ","day(s)"]})]})]})]}),t.notes&&e.jsx("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-700",children:t.notes})}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:["Booked on ",m(new Date(t.createdAt),"MMM dd, yyyy")]}),e.jsxs("div",{className:"flex space-x-3",children:[a&&e.jsx(g,{to:`/products/${a._id}`,className:"text-brand hover:text-blue-700 text-sm font-medium",children:"View Product"}),c&&e.jsx("button",{onClick:()=>d(t._id),className:"text-red-600 hover:text-red-700 text-sm font-medium",children:"Cancel Booking"})]})]})]})]})})})}export{_ as default};
