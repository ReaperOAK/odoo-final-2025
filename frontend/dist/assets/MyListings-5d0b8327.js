import{r as a,u as M,e as F,V as m,j as e,t as $,L as h,o as b,n as w,l as I}from"./index-76169fad.js";import{g as D,t as T,d as _}from"./listings-af106268.js";import{f as H}from"./formatters-7e5feb33.js";import{C as Z}from"./ChartBarIcon-105c5e5a.js";import{P as k}from"./PhotoIcon-c505ca73.js";import{M as O}from"./MapPinIcon-dea18e68.js";import{P as V}from"./PencilIcon-5662a8f4.js";import{T as Y}from"./TrashIcon-743e22ce.js";function G({title:i,titleId:l,...d},o){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":l},d),i?a.createElement("title",{id:l},i):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 8.25H9m6 3H9m3 6-3-3h1.5a3 3 0 1 0 0-6M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const U=a.forwardRef(G),W=U;function q({title:i,titleId:l,...d},o){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":l},d),i?a.createElement("title",{id:l},i):null,a.createElement("path",{d:"M3.53 2.47a.75.75 0 0 0-1.06 1.06l18 18a.75.75 0 1 0 1.06-1.06l-18-18ZM22.676 12.553a11.249 11.249 0 0 1-2.631 4.31l-3.099-3.099a5.25 5.25 0 0 0-6.71-6.71L7.759 4.577a11.217 11.217 0 0 1 4.242-.827c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113Z"}),a.createElement("path",{d:"M15.75 12c0 .18-.013.357-.037.53l-4.244-4.243A3.75 3.75 0 0 1 15.75 12ZM12.53 15.713l-4.243-4.244a3.75 3.75 0 0 0 4.244 4.243Z"}),a.createElement("path",{d:"M6.75 12c0-.619.107-1.213.304-1.764l-3.1-3.1a11.25 11.25 0 0 0-2.63 4.31c-.12.362-.12.752 0 1.114 1.489 4.467 5.704 7.69 10.675 7.69 1.5 0 2.933-.294 4.242-.827l-2.477-2.477A5.25 5.25 0 0 1 6.75 12Z"}))}const z=a.forwardRef(q),J=z;function ie(){const[i,l]=a.useState([]),[d,o]=a.useState(!0),[f,j]=a.useState(null),[n,L]=a.useState("all"),[v,E]=a.useState("newest"),[x,S]=a.useState({total:0,active:0,inactive:0,totalRevenue:0,totalBookings:0}),{user:K,isHost:p}=M(),N=F();a.useEffect(()=>{if(!p()){N("/");return}y()},[p,N]);const y=async()=>{try{o(!0);const s=await D();l(s.data.listings),R(s.data.listings),j(null)}catch(s){console.error("Error fetching listings:",s),j("Failed to load your listings"),m.error("Failed to load your listings")}finally{o(!1)}},R=s=>{const r={total:s.length,active:s.filter(t=>t.status==="active").length,inactive:s.filter(t=>t.status==="inactive").length,totalRevenue:s.reduce((t,c)=>t+(c.totalRevenue||0),0),totalBookings:s.reduce((t,c)=>t+(c.totalBookings||0),0)};S(r)},A=async(s,r)=>{try{const t=r==="active"?"inactive":"active";await T(s,t),l(c=>c.map(u=>u._id===s?{...u,status:t}:u)),m.success(`Listing ${t==="active"?"activated":"deactivated"} successfully`)}catch(t){console.error("Error toggling listing status:",t),m.error("Failed to update listing status")}},C=async(s,r)=>{if(window.confirm(`Are you sure you want to delete "${r}"?`))try{await _(s),l(t=>t.filter(c=>c._id!==s)),m.success("Listing deleted successfully")}catch(t){console.error("Error deleting listing:",t),m.error("Failed to delete listing")}},B=()=>{let s=i;return n!=="all"&&(s=s.filter(r=>r.status===n)),s.sort((r,t)=>{switch(v){case"newest":return new Date(t.createdAt)-new Date(r.createdAt);case"oldest":return new Date(r.createdAt)-new Date(t.createdAt);case"price-high":return t.pricePerDay-r.pricePerDay;case"price-low":return r.pricePerDay-t.pricePerDay;case"bookings":return(t.totalBookings||0)-(r.totalBookings||0);default:return 0}})},P=s=>{switch(s){case"active":return"bg-green-100 text-green-800";case"inactive":return"bg-gray-100 text-gray-800";case"draft":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}};if(d)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand"})});if(f)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx($,{className:"mx-auto h-12 w-12 text-red-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Error"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:f}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:y,className:"bg-brand text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-blue-700",children:"Try Again"})})]})});const g=B();return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"My Listings"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Manage your rental listings"})]}),e.jsx("div",{className:"mt-4 sm:mt-0",children:e.jsxs(h,{to:"/listings/create",className:"inline-flex items-center px-4 py-2 bg-brand text-white rounded-md hover:bg-blue-700 transition-colors",children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Add New Listing"]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Z,{className:"h-8 w-8 text-brand"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Listings"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:x.total})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(w,{className:"h-8 w-8 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:x.active})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(J,{className:"h-8 w-8 text-gray-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Inactive"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:x.inactive})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(I,{className:"h-8 w-8 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Bookings"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:x.totalBookings})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(W,{className:"h-8 w-8 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["₹",x.totalRevenue.toLocaleString()]})]})]})})]}),e.jsx("div",{className:"bg-white rounded-lg shadow mb-6",children:e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("select",{value:n,onChange:s=>L(s.target.value),className:"block border-gray-300 rounded-md shadow-sm focus:ring-brand focus:border-brand",children:[e.jsx("option",{value:"all",children:"All Listings"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"draft",children:"Draft"})]}),e.jsxs("select",{value:v,onChange:s=>E(s.target.value),className:"block border-gray-300 rounded-md shadow-sm focus:ring-brand focus:border-brand",children:[e.jsx("option",{value:"newest",children:"Newest First"}),e.jsx("option",{value:"oldest",children:"Oldest First"}),e.jsx("option",{value:"price-high",children:"Price: High to Low"}),e.jsx("option",{value:"price-low",children:"Price: Low to High"}),e.jsx("option",{value:"bookings",children:"Most Bookings"})]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",g.length," of ",i.length," listings"]})]})})}),g.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[e.jsx(k,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:n==="all"?"No listings yet":`No ${n} listings`}),e.jsx("p",{className:"mt-2 text-gray-600",children:n==="all"?"Get started by creating your first listing.":`You don't have any ${n} listings.`}),n==="all"&&e.jsx("div",{className:"mt-6",children:e.jsxs(h,{to:"/listings/create",className:"inline-flex items-center px-4 py-2 bg-brand text-white rounded-md hover:bg-blue-700 transition-colors",children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Create Your First Listing"]})})]}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:g.map(s=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsxs("div",{className:"relative h-48",children:[s.images&&s.images.length>0?e.jsx("img",{src:s.images[0],alt:s.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full bg-gray-200 flex items-center justify-center",children:e.jsx(k,{className:"h-12 w-12 text-gray-400"})}),e.jsx("div",{className:"absolute top-3 left-3",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${P(s.status)}`,children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})}),s.images&&s.images.length>1&&e.jsxs("div",{className:"absolute top-3 right-3 bg-black bg-opacity-75 text-white text-xs px-2 py-1 rounded",children:[s.images.length," photos"]})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2 line-clamp-2",children:s.title}),e.jsxs("div",{className:"flex items-center text-gray-600 mb-2",children:[e.jsx(O,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"text-sm",children:s.location})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"text-lg font-bold text-gray-900",children:[H(s.pricePerDay),"/day"]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[s.totalBookings||0," bookings"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4 pt-4 border-t border-gray-100",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Revenue"}),e.jsxs("p",{className:"font-semibold text-green-600",children:["₹",(s.totalRevenue||0).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Rating"}),e.jsx("p",{className:"font-semibold",children:s.averageRating?`${s.averageRating.toFixed(1)} ⭐`:"No ratings"})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(h,{to:`/listings/${s._id}`,className:"flex-1 bg-gray-100 text-gray-700 px-3 py-2 rounded-md text-sm font-medium hover:bg-gray-200 transition-colors text-center",children:[e.jsx(w,{className:"w-4 h-4 inline mr-1"}),"View"]}),e.jsxs(h,{to:`/listings/${s._id}/edit`,className:"flex-1 bg-blue-100 text-blue-700 px-3 py-2 rounded-md text-sm font-medium hover:bg-blue-200 transition-colors text-center",children:[e.jsx(V,{className:"w-4 h-4 inline mr-1"}),"Edit"]}),e.jsx("button",{onClick:()=>A(s._id,s.status),className:`flex-1 px-3 py-2 rounded-md text-sm font-medium transition-colors ${s.status==="active"?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:s.status==="active"?"Deactivate":"Activate"}),e.jsx("button",{onClick:()=>C(s._id,s.title),className:"bg-red-100 text-red-700 px-3 py-2 rounded-md text-sm font-medium hover:bg-red-200 transition-colors",children:e.jsx(Y,{className:"w-4 h-4"})})]})]})]},s._id))})]})})}export{ie as default};
