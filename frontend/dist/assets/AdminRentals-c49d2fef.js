import{r as i,j as e,l as w,U as D,b as M,c as R}from"./index-76169fad.js";import{r as b}from"./rentals-588bb37c.js";import{S as A}from"./StatusChip-0f94ae11.js";import{M as F}from"./MagnifyingGlassIcon-c9e2ef4c.js";import{F as P}from"./FunnelIcon-3d36d466.js";import{P as I}from"./PhotoIcon-c505ca73.js";import{f as h}from"./index-11ece73b.js";import"./index-e31d7439.js";function G(){const[a,x]=i.useState([]),[r,n]=i.useState(!0),[c,m]=i.useState(""),[t,k]=i.useState("all"),[u,C]=i.useState("-createdAt");i.useEffect(()=>{g()},[t,u]);const g=async()=>{var s;try{n(!0);const l={limit:100,sort:u};t!=="all"&&(l.status=t);const d=await b.getAllRentals(l);x(((s=d.data)==null?void 0:s.rentals)||[])}catch(l){console.error("Failed to fetch rentals:",l)}finally{n(!1)}},S=async(s,l)=>{try{await b.updateRentalStatus(s,l),await g()}catch(d){console.error("Failed to update rental status:",d),alert("Failed to update rental status. Please try again.")}},f=a.filter(s=>{var d,j,p,y,v,N;const l=c.toLowerCase();return((j=(d=s.user)==null?void 0:d.name)==null?void 0:j.toLowerCase().includes(l))||((y=(p=s.user)==null?void 0:p.email)==null?void 0:y.toLowerCase().includes(l))||((N=(v=s.product)==null?void 0:v.name)==null?void 0:N.toLowerCase().includes(l))}),o=(()=>({all:a.length,confirmed:a.filter(s=>s.status==="confirmed").length,picked_up:a.filter(s=>s.status==="picked_up").length,returned:a.filter(s=>s.status==="returned").length,cancelled:a.filter(s=>s.status==="cancelled").length}))();return r?e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-48 mb-8"}),e.jsx("div",{className:"space-y-6",children:[...Array(5)].map((s,l)=>e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-lg"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/4"})]})]})},l))})]})})}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Manage Rentals"}),e.jsx("p",{className:"text-gray-600",children:"Monitor and manage all rental bookings"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(F,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Search rentals...",value:c,onChange:s=>m(s.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-2 focus:ring-brand focus:border-brand"})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{className:"h-5 w-5 text-gray-400 mr-2"}),e.jsxs("select",{value:u,onChange:s=>C(s.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-brand focus:border-brand",children:[e.jsx("option",{value:"-createdAt",children:"Newest First"}),e.jsx("option",{value:"createdAt",children:"Oldest First"}),e.jsx("option",{value:"startDate",children:"Start Date"}),e.jsx("option",{value:"-totalPrice",children:"Highest Value"}),e.jsx("option",{value:"totalPrice",children:"Lowest Value"})]})]})})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{key:"all",label:"All Rentals",count:o.all},{key:"confirmed",label:"Confirmed",count:o.confirmed},{key:"picked_up",label:"Active",count:o.picked_up},{key:"returned",label:"Completed",count:o.returned},{key:"cancelled",label:"Cancelled",count:o.cancelled}].map(s=>e.jsxs("button",{onClick:()=>k(s.key),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${t===s.key?"bg-brand text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[s.label," (",s.count,")"]},s.key))})]}),f.length>0?e.jsx("div",{className:"space-y-6",children:f.map(s=>e.jsx(_,{rental:s,onStatusUpdate:S},s._id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-24 h-24 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(w,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:c?"No rentals found":t==="all"?"No rentals yet":`No ${t} rentals`}),e.jsx("p",{className:"text-gray-600",children:c?`No results for "${c}"`:t==="all"?"Rental bookings will appear here as customers make reservations":`No ${t} rentals at the moment`})]})]})})}function _({rental:a,onStatusUpdate:x}){var m;const r=a.product,n=a.user,c=[{value:"confirmed",label:"Confirmed"},{value:"picked_up",label:"Picked Up"},{value:"returned",label:"Returned"},{value:"cancelled",label:"Cancelled"}];return e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-lg overflow-hidden",children:(m=r==null?void 0:r.images)!=null&&m[0]?e.jsx("img",{src:r.images[0],alt:r.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(I,{className:"w-6 h-6 text-gray-400"})})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:(r==null?void 0:r.name)||"Product not found"}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-2",children:[e.jsx(D,{className:"w-4 h-4 mr-1"}),e.jsxs("span",{children:[(n==null?void 0:n.name)||"Unknown User"," (",(n==null?void 0:n.email)||"No email",")"]})]}),e.jsx(A,{status:a.status})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-brand",children:["â‚¹",a.totalPrice]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Value"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm mb-4",children:[e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Start Date"}),e.jsx("div",{children:h(new Date(a.startDate),"MMM dd, yyyy HH:mm")})]})]}),e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"End Date"}),e.jsx("div",{children:h(new Date(a.endDate),"MMM dd, yyyy HH:mm")})]})]}),e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Duration"}),e.jsxs("div",{children:[Math.ceil((new Date(a.endDate)-new Date(a.startDate))/(1e3*60*60*24))," ","day(s)"]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:["Booked on ",h(new Date(a.createdAt),"MMM dd, yyyy")]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Status:"}),e.jsx("select",{value:a.status,onChange:t=>x(a._id,t.target.value),className:"text-sm border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-brand focus:border-brand",children:c.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]})]})]})]})})})}export{G as default};
