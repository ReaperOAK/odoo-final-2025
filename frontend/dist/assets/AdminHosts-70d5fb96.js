import{r as i,u as T,V as m,j as e,t as B,b as $,H as k,n as q,f as z,X as C}from"./index-76169fad.js";import{a as G,b as O,s as P}from"./hosts-a0d77ddc.js";import{U as A}from"./UserGroupIcon-c7482618.js";import{C as X}from"./CheckBadgeIcon-eecae9d8.js";import{M as J}from"./MagnifyingGlassIcon-c9e2ef4c.js";function W({title:c,titleId:l,...p},h){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:h,"aria-labelledby":l},p),c?i.createElement("title",{id:l},c):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.364 18.364A9 9 0 0 0 5.636 5.636m12.728 12.728A9 9 0 0 1 5.636 5.636m12.728 12.728L5.636 5.636"}))}const Z=i.forwardRef(W),K=Z;function ae(){const[c,l]=i.useState([]),[p,h]=i.useState(!0),[y,N]=i.useState(null),[d,H]=i.useState(""),[f,V]=i.useState("all"),[o,R]=i.useState("all"),[w,F]=i.useState("newest"),[r,L]=i.useState(null),[E,x]=i.useState(!1),[u,I]=i.useState({total:0,verified:0,pending:0,suspended:0}),{isAdmin:b}=T();i.useEffect(()=>{if(!b()){window.location.href="/";return}S()},[b]);const S=async()=>{try{h(!0);const s=await G();l(s.data.hosts),M(s.data.hosts),N(null)}catch(s){console.error("Error fetching hosts:",s),N("Failed to load hosts"),m.error("Failed to load hosts")}finally{h(!1)}},M=s=>{const t={total:s.length,verified:s.filter(a=>a.isVerified).length,pending:s.filter(a=>a.verificationStatus==="pending").length,suspended:s.filter(a=>a.status==="suspended").length};I(t)},g=async(s,t,a="")=>{try{await O(s,{status:t,reason:a}),l(n=>n.map(v=>v._id===s?{...v,verificationStatus:t,isVerified:t==="approved",verificationReason:a}:v)),m.success(`Host verification ${t} successfully`),x(!1)}catch(n){console.error("Error updating host verification:",n),m.error("Failed to update host verification")}},_=async(s,t)=>{if(window.confirm("Are you sure you want to suspend this host?"))try{await P(s,{reason:t}),l(a=>a.map(n=>n._id===s?{...n,status:"suspended",suspensionReason:t}:n)),m.success("Host suspended successfully"),x(!1)}catch(a){console.error("Error suspending host:",a),m.error("Failed to suspend host")}},D=()=>{let s=c;return d&&(s=s.filter(t=>{var a;return t.name.toLowerCase().includes(d.toLowerCase())||t.email.toLowerCase().includes(d.toLowerCase())||((a=t.location)==null?void 0:a.toLowerCase().includes(d.toLowerCase()))})),f!=="all"&&(s=s.filter(t=>t.status===f)),o!=="all"&&(o==="verified"?s=s.filter(t=>t.isVerified):o==="pending"?s=s.filter(t=>t.verificationStatus==="pending"):o==="rejected"&&(s=s.filter(t=>t.verificationStatus==="rejected"))),s.sort((t,a)=>{switch(w){case"newest":return new Date(a.createdAt)-new Date(t.createdAt);case"oldest":return new Date(t.createdAt)-new Date(a.createdAt);case"name":return t.name.localeCompare(a.name);case"listings":return(a.listingsCount||0)-(t.listingsCount||0);case"revenue":return(a.totalRevenue||0)-(t.totalRevenue||0);default:return 0}})},U=s=>{switch(s){case"active":return"bg-green-100 text-green-800";case"suspended":return"bg-red-100 text-red-800";case"inactive":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};if(p)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand"})});if(y)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(B,{className:"mx-auto h-12 w-12 text-red-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Error"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:y}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:S,className:"bg-brand text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-blue-700",children:"Try Again"})})]})});const j=D();return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Host Management"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Manage host verification and monitoring"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(A,{className:"h-8 w-8 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Hosts"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:u.total})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(X,{className:"h-8 w-8 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Verified"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:u.verified})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx($,{className:"h-8 w-8 text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:u.pending})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(K,{className:"h-8 w-8 text-red-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Suspended"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:u.suspended})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:[e.jsx("div",{className:"flex-1 max-w-lg",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(J,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Search hosts...",value:d,onChange:s=>H(s.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:ring-brand focus:border-brand"})]})}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("select",{value:f,onChange:s=>V(s.target.value),className:"block border-gray-300 rounded-md shadow-sm focus:ring-brand focus:border-brand",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"suspended",children:"Suspended"})]}),e.jsxs("select",{value:o,onChange:s=>R(s.target.value),className:"block border-gray-300 rounded-md shadow-sm focus:ring-brand focus:border-brand",children:[e.jsx("option",{value:"all",children:"All Verification"}),e.jsx("option",{value:"verified",children:"Verified"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"rejected",children:"Rejected"})]}),e.jsxs("select",{value:w,onChange:s=>F(s.target.value),className:"block border-gray-300 rounded-md shadow-sm focus:ring-brand focus:border-brand",children:[e.jsx("option",{value:"newest",children:"Newest First"}),e.jsx("option",{value:"oldest",children:"Oldest First"}),e.jsx("option",{value:"name",children:"Name A-Z"}),e.jsx("option",{value:"listings",children:"Most Listings"}),e.jsx("option",{value:"revenue",children:"Highest Revenue"})]})]})]})}),e.jsx("div",{className:"px-6 py-3 bg-gray-50",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",j.length," of ",c.length," hosts"]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Host"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Verification"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Listings"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Revenue"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Joined"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:j.map(s=>{var t,a;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:s.profileImage?e.jsx("img",{className:"h-10 w-10 rounded-full object-cover",src:s.profileImage,alt:""}):e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-gray-700",children:s.name.charAt(0).toUpperCase()})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.email}),s.location&&e.jsx("div",{className:"text-xs text-gray-400",children:s.location})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${U(s.status)}`,children:((t=s.status)==null?void 0:t.charAt(0).toUpperCase())+((a=s.status)==null?void 0:a.slice(1))||"Active"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(k,{host:s,size:"small"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.listingsCount||0}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["â‚¹",(s.totalRevenue||0).toLocaleString()]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(s.createdAt).toLocaleDateString()}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>{L(s),x(!0)},className:"text-brand hover:text-blue-700 mr-3",children:e.jsx(q,{className:"w-4 h-4"})}),s.verificationStatus==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>g(s._id,"approved"),className:"text-green-600 hover:text-green-700 mr-3",title:"Approve Verification",children:e.jsx(z,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>g(s._id,"rejected","Did not meet verification requirements"),className:"text-red-600 hover:text-red-700 mr-3",title:"Reject Verification",children:e.jsx(C,{className:"w-4 h-4"})})]})]})]},s._id)})})]})}),j.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(A,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No hosts found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"No hosts match your current filters."})]})]}),E&&r&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-20 mx-auto p-5 border w-11/12 max-w-2xl shadow-lg rounded-md bg-white",children:e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Host Details"}),e.jsx("button",{onClick:()=>x(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(C,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[r.profileImage?e.jsx("img",{className:"h-16 w-16 rounded-full object-cover",src:r.profileImage,alt:""}):e.jsx("div",{className:"h-16 w-16 rounded-full bg-gray-300 flex items-center justify-center",children:e.jsx("span",{className:"text-lg font-medium text-gray-700",children:r.name.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:r.name}),e.jsx("p",{className:"text-gray-600",children:r.email}),r.phone&&e.jsx("p",{className:"text-gray-600",children:r.phone})]})]}),r.bio&&e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-gray-900 mb-2",children:"About"}),e.jsx("p",{className:"text-gray-600",children:r.bio})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-gray-900 mb-2",children:"Verification Status"}),e.jsx(k,{host:r}),r.verificationReason&&e.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Reason: ",r.verificationReason]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[r.verificationStatus==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>g(r._id,"approved"),className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700",children:"Approve Verification"}),e.jsx("button",{onClick:()=>g(r._id,"rejected","Did not meet verification requirements"),className:"bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700",children:"Reject Verification"})]}),r.status!=="suspended"&&e.jsx("button",{onClick:()=>_(r._id,"Violation of terms"),className:"bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700",children:"Suspend Host"}),e.jsx("button",{onClick:()=>x(!1),className:"bg-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-400",children:"Close"})]})]})]})})})]})})}export{ae as default};
